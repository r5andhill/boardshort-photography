<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Golden Hour — A Daily Archive</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=Geist+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #f7f5f0;
    --ink: #1a1814;
    --ink-light: #7a7570;
    --ink-faint: #c8c4bc;
    --accent: #c8834a;
    --gap-color: rgba(200,196,188,0.18);
    --font-serif: 'Cormorant Garamond', Georgia, serif;
    --font-mono: 'Geist Mono', 'Courier New', monospace;
    --thumb-h: 84px;
    --thumb-h-mobile: 56px;
  }

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { scroll-behavior: smooth; }

body {
background: var(–bg);
color: var(–ink);
font-family: var(–font-serif);
min-height: 100vh;
overflow-x: hidden;
}

/* ── HEADER ── */
header {
padding: 52px 48px 36px;
display: flex;
align-items: baseline;
justify-content: space-between;
border-bottom: 1px solid var(–ink-faint);
}
.site-title {
font-size: clamp(1.1rem, 2vw, 1.4rem);
font-weight: 300;
letter-spacing: 0.22em;
text-transform: uppercase;
color: var(–ink);
}
.site-subtitle {
font-family: var(–font-mono);
font-size: 0.68rem;
color: var(–ink-light);
letter-spacing: 0.08em;
}

/* ── HERO ── */
.hero {
padding: 0 48px;
margin: 0;
position: relative;
overflow: hidden;
cursor: pointer;
}
.hero img, .hero video {
width: 100%;
height: clamp(320px, 52vh, 640px);
object-fit: cover;
display: block;
transition: opacity 0.4s;
}
.hero:hover img, .hero:hover video { opacity: 0.92; }
.hero-meta {
position: absolute;
bottom: 0;
left: 48px;
right: 48px;
padding: 32px 24px 20px;
background: linear-gradient(transparent, rgba(26,24,20,0.72));
color: #f7f5f0;
display: flex;
justify-content: space-between;
align-items: flex-end;
}
.hero-caption { font-size: clamp(1rem, 2.2vw, 1.5rem); font-style: italic; font-weight: 300; max-width: 60%; line-height: 1.35; }
.hero-data { font-family: var(–font-mono); font-size: 0.64rem; text-align: right; line-height: 1.9; opacity: 0.85; }
.hero-tag {
position: absolute;
top: 16px;
left: 72px;
font-family: var(–font-mono);
font-size: 0.6rem;
letter-spacing: 0.14em;
text-transform: uppercase;
background: var(–accent);
color: #fff;
padding: 3px 8px;
}

/* ── TIMELINE ── */
.timeline {
padding: 0 48px 80px;
}

/* ── DAY ROW ── */
.day-block {
border-top: 1px solid var(–ink-faint);
padding: 28px 0 20px;
}
.day-header {
display: flex;
align-items: baseline;
gap: 20px;
margin-bottom: 16px;
}
.day-date {
font-family: var(–font-mono);
font-size: 0.65rem;
letter-spacing: 0.12em;
color: var(–ink-light);
text-transform: uppercase;
}
.day-count {
font-family: var(–font-mono);
font-size: 0.58rem;
color: var(–ink-faint);
}

/* ── CONTACT STRIP ── */
/*
Layout rule:
- Sunrise thumbnails anchor LEFT
- Sunset thumbnails anchor RIGHT
- The gap between them is whatever space remains
- More images = smaller gap (denser contact sheet)
- Fewer images = larger gap (airy, contemplative)
*/
.contact-strip {
display: flex;
justify-content: space-between;
align-items: flex-end;
gap: 0;
width: 100%;
min-height: var(–thumb-h);
}
.cluster {
display: flex;
align-items: flex-end;
gap: 3px;
flex-shrink: 0;
}
.cluster-sunrise { justify-content: flex-start; }
.cluster-sunset  { justify-content: flex-end; }

/* the gap lives between clusters — it’s implicit, not coded */

.thumb-wrap {
position: relative;
height: var(–thumb-h);
flex-shrink: 0;
cursor: pointer;
overflow: hidden;
}
.thumb-wrap img,
.thumb-wrap video {
height: 100%;
width: auto;
min-width: 40px;
display: block;
object-fit: cover;
transition: opacity 0.25s, transform 0.3s;
transform-origin: bottom center;
}
.thumb-wrap:hover img,
.thumb-wrap:hover video { opacity: 0.78; transform: scaleY(1.04); }

/* video badge */
.thumb-wrap.is-video::after {
content: ‘▶’;
position: absolute;
bottom: 5px;
right: 6px;
font-size: 0.55rem;
color: #fff;
opacity: 0.85;
text-shadow: 0 1px 3px rgba(0,0,0,0.6);
pointer-events: none;
}

/* vertical thumb — narrower, same height */
.thumb-wrap.vertical img,
.thumb-wrap.vertical video { width: calc(var(–thumb-h) * 0.67); }

/* tag pill on thumb (sunrise/sunset) */
.thumb-tag {
position: absolute;
top: 4px;
left: 4px;
font-family: var(–font-mono);
font-size: 0.48rem;
letter-spacing: 0.1em;
text-transform: uppercase;
padding: 2px 5px;
pointer-events: none;
opacity: 0;
transition: opacity 0.2s;
}
.thumb-wrap:hover .thumb-tag { opacity: 1; }
.thumb-tag.sunrise { background: rgba(248,210,140,0.9); color: #5a3a00; }
.thumb-tag.sunset  { background: rgba(200,100,60,0.85); color: #fff; }

/* gap label (appears on hover of strip) */
.gap-zone {
flex: 1;
min-width: 12px;
position: relative;
display: flex;
align-items: center;
justify-content: center;
}
.gap-label {
font-family: var(–font-mono);
font-size: 0.52rem;
color: var(–ink-faint);
letter-spacing: 0.1em;
text-transform: uppercase;
opacity: 0;
transition: opacity 0.3s;
white-space: nowrap;
pointer-events: none;
user-select: none;
}
.day-block:hover .gap-label { opacity: 1; }

/* ── LIGHTBOX ── */
.lightbox {
display: none;
position: fixed;
inset: 0;
z-index: 1000;
background: rgba(20,18,14,0.97);
align-items: center;
justify-content: center;
flex-direction: column;
}
.lightbox.open { display: flex; }

.lb-media {
max-width: 92vw;
max-height: 78vh;
object-fit: contain;
display: block;
}
.lb-controls {
position: absolute;
top: 50%;
transform: translateY(-50%);
width: 100%;
display: flex;
justify-content: space-between;
padding: 0 24px;
pointer-events: none;
}
.lb-arrow {
pointer-events: all;
background: none;
border: 1px solid rgba(247,245,240,0.2);
color: rgba(247,245,240,0.7);
font-family: var(–font-mono);
font-size: 1rem;
width: 44px;
height: 44px;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
transition: border-color 0.2s, color 0.2s, background 0.2s;
}
.lb-arrow:hover { border-color: rgba(247,245,240,0.6); color: #f7f5f0; background: rgba(247,245,240,0.06); }
.lb-arrow:disabled { opacity: 0.15; cursor: default; }

.lb-close {
position: absolute;
top: 20px;
right: 24px;
background: none;
border: none;
color: rgba(247,245,240,0.5);
font-family: var(–font-mono);
font-size: 0.75rem;
letter-spacing: 0.12em;
cursor: pointer;
padding: 6px 10px;
transition: color 0.2s;
}
.lb-close:hover { color: #f7f5f0; }

.lb-info {
position: absolute;
bottom: 0;
left: 0;
right: 0;
padding: 28px 48px 32px;
background: linear-gradient(transparent, rgba(20,18,14,0.9));
display: flex;
justify-content: space-between;
align-items: flex-end;
gap: 24px;
}
.lb-caption {
color: #f7f5f0;
font-size: clamp(1rem, 2vw, 1.35rem);
font-style: italic;
font-weight: 300;
max-width: 55%;
line-height: 1.4;
}
.lb-meta {
font-family: var(–font-mono);
font-size: 0.62rem;
color: rgba(247,245,240,0.7);
text-align: right;
line-height: 2;
}
.lb-meta .tag-pill {
display: inline-block;
padding: 2px 7px;
font-size: 0.55rem;
letter-spacing: 0.1em;
text-transform: uppercase;
margin-bottom: 4px;
}
.lb-meta .tag-pill.sunrise { background: rgba(248,210,140,0.8); color: #5a3a00; }
.lb-meta .tag-pill.sunset  { background: rgba(200,100,60,0.8); color: #fff; }

.lb-counter {
position: absolute;
top: 22px;
left: 50%;
transform: translateX(-50%);
font-family: var(–font-mono);
font-size: 0.6rem;
color: rgba(247,245,240,0.35);
letter-spacing: 0.1em;
}

/* ── FOOTER ── */
footer {
border-top: 1px solid var(–ink-faint);
padding: 24px 48px;
display: flex;
justify-content: space-between;
align-items: center;
}
.footer-text {
font-family: var(–font-mono);
font-size: 0.6rem;
color: var(–ink-faint);
letter-spacing: 0.1em;
}

/* ── MOBILE ── */
@media (max-width: 700px) {
header, .hero, .timeline, .lb-info, footer { padding-left: 20px; padding-right: 20px; }
.hero-meta { left: 20px; right: 20px; }
.hero-tag  { left: 24px; }
:root { –thumb-h: 56px; }
.gap-label { display: none; }
.lb-caption { max-width: 100%; margin-bottom: 12px; }
.lb-info { flex-direction: column; align-items: flex-start; }
.lb-meta { text-align: left; }
.lb-controls { padding: 0 10px; }
header { padding-top: 28px; flex-direction: column; gap: 6px; }
}

/* ── FADE IN ── */
@keyframes fadeUp {
from { opacity: 0; transform: translateY(12px); }
to   { opacity: 1; transform: translateY(0); }
}
.day-block {
animation: fadeUp 0.5s ease both;
}
.day-block:nth-child(1) { animation-delay: 0.05s; }
.day-block:nth-child(2) { animation-delay: 0.15s; }
.day-block:nth-child(3) { animation-delay: 0.25s; }
.day-block:nth-child(4) { animation-delay: 0.35s; }
</style>

</head>
<body>

<!-- ── HEADER ── -->

<header>
  <span class="site-title">Golden Hour</span>
  <span class="site-subtitle">A Daily Archive of Light - at its Edges</span>
</header>

<!-- ── HERO (Featured Image) ── -->

<div class="hero" id="hero-wrap" onclick="openLightboxFromHero()">
  <img id="hero-img" src="" alt="Featured photograph">
  <div class="hero-tag" id="hero-tag">Sunrise</div>
  <div class="hero-meta">
    <div class="hero-caption" id="hero-caption"></div>
    <div class="hero-data" id="hero-data"></div>
  </div>
</div>

<!-- ── TIMELINE ── -->

<div class="timeline" id="timeline"></div>

<!-- ── LIGHTBOX ── -->

<div class="lightbox" id="lightbox">
  <button class="lb-close" onclick="closeLightbox()">ESC · CLOSE</button>
  <div class="lb-counter" id="lb-counter"></div>
  <img class="lb-media" id="lb-img" src="" alt="" style="display:none">
  <video class="lb-media" id="lb-video" autoplay muted loop playsinline style="display:none"></video>
  <div class="lb-controls">
    <button class="lb-arrow" id="lb-prev" onclick="stepLightbox(-1)">←</button>
    <button class="lb-arrow" id="lb-next" onclick="stepLightbox(1)">→</button>
  </div>
  <div class="lb-info">
    <div class="lb-caption" id="lb-caption"></div>
    <div class="lb-meta" id="lb-meta"></div>
  </div>
</div>

<!-- ── FOOTER ── -->

<footer>
  <span class="footer-text">© 2025 · Updated daily at first and last light</span>
  <span class="footer-text" id="footer-count"></span>
</footer>

<script>
// ═══════════════════════════════════════════════════════════
// CONTENT DATA
// In production this will be loaded from JSON files in /content/
// Each entry has: id, src, type (image|video), orientation (h|v),
// caption, timestamp (ISO 8601), lat, lng, location, weather, tag (auto)
// ═══════════════════════════════════════════════════════════

// Using beautiful placeholder images from Unsplash (real sunrise/sunset photos)
const DAYS = [
  {
    date: "2025-06-14",
    label: "Saturday, June 14",
    hero: true, // this day's hero image is the site hero
    heroIndex: 2,
    images: [
      // SUNRISE (before noon → anchors LEFT)
      { id:"s1", src:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80", type:"image", orientation:"h", caption:"First light over the ridge", time:"05:47", location:"Marin Headlands, CA", weather:"58°F · Clear · Wind SW 6mph", tag:"sunrise" },
      { id:"s2", src:"https://images.unsplash.com/photo-1470252649378-9c29740c9fa8?w=800&q=80", type:"image", orientation:"h", caption:"The horizon holds its breath", time:"05:53", location:"Marin Headlands, CA", weather:"59°F · Clear · Wind SW 6mph", tag:"sunrise" },
      { id:"s3", src:"https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?w=600&q=80", type:"image", orientation:"v", caption:"Vertical light", time:"06:01", location:"Marin Headlands, CA", weather:"60°F · Clear", tag:"sunrise" },
      { id:"s4", src:"https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=800&q=80", type:"image", orientation:"h", caption:"Golden wash on the water", time:"06:14", location:"Marin Headlands, CA", weather:"61°F · Clear", tag:"sunrise" },
      { id:"s5", src:"https://images.unsplash.com/photo-1490750967868-88df5691cc51?w=800&q=80", type:"image", orientation:"h", caption:"The pink hour", time:"06:28", location:"Marin Headlands, CA", weather:"62°F · Partly cloudy", tag:"sunrise" },
      // SUNSET (after noon → anchors RIGHT)
      { id:"u1", src:"https://images.unsplash.com/photo-1495616811223-4d98c6e9c869?w=800&q=80", type:"image", orientation:"h", caption:"Last embers", time:"20:11", location:"Marin Headlands, CA", weather:"68°F · Clear · Wind NW 12mph", tag:"sunset" },
      { id:"u2", src:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=600&q=80", type:"image", orientation:"v", caption:"Silhouette", time:"20:19", location:"Marin Headlands, CA", weather:"67°F · Clear", tag:"sunset" },
      { id:"u3", src:"https://images.unsplash.com/photo-1418065460487-3e41a6c84dc5?w=800&q=80", type:"image", orientation:"h", caption:"Afterglow lingers", time:"20:34", location:"Marin Headlands, CA", weather:"65°F · Clear", tag:"sunset" },
    ]
  },
  {
    date: "2025-06-13",
    label: "Friday, June 13",
    images: [
      { id:"a1", src:"https://images.unsplash.com/photo-1531366936337-7c912a4589a7?w=800&q=80", type:"image", orientation:"h", caption:"Marine layer burns off", time:"06:02", location:"Baker Beach, CA", weather:"55°F · Fog · Wind W 8mph", tag:"sunrise" },
      { id:"a2", src:"https://images.unsplash.com/photo-1504701954957-2010ec3bcec1?w=800&q=80", type:"image", orientation:"h", caption:"Through the fog", time:"06:18", location:"Baker Beach, CA", weather:"56°F · Fog clearing", tag:"sunrise" },
      { id:"a3", src:"https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?w=800&q=80", type:"image", orientation:"h", caption:"City wakes", time:"06:31", location:"Baker Beach, CA", weather:"58°F · Partly cloudy", tag:"sunrise" },
      { id:"b1", src:"https://images.unsplash.com/photo-1529963183134-61a90db47eaf?w=800&q=80", type:"image", orientation:"h", caption:"Dusk palette", time:"19:58", location:"Baker Beach, CA", weather:"64°F · Clear · Wind NW 10mph", tag:"sunset" },
      { id:"b2", src:"https://images.unsplash.com/photo-1519046904884-53103b34b206?w=800&q=80", type:"image", orientation:"h", caption:"Tide retreats", time:"20:05", location:"Baker Beach, CA", weather:"63°F · Clear", tag:"sunset" },
      { id:"b3", src:"https://images.unsplash.com/photo-1501854140801-50d01698950b?w=600&q=80", type:"image", orientation:"v", caption:"The last vertical", time:"20:22", location:"Baker Beach, CA", weather:"62°F · Clear", tag:"sunset" },
      { id:"b4", src:"https://images.unsplash.com/photo-1433086966358-54859d0ed716?w=800&q=80", type:"image", orientation:"h", caption:"Waterfall light", time:"20:39", location:"Baker Beach, CA", weather:"61°F · Clear", tag:"sunset" },
    ]
  },
  {
    date: "2025-06-12",
    label: "Thursday, June 12",
    images: [
      { id:"c1", src:"https://images.unsplash.com/photo-1494059980473-813e73ee784b?w=800&q=80", type:"image", orientation:"h", caption:"Pre-dawn stillness", time:"05:51", location:"Point Reyes, CA", weather:"52°F · Clear · Wind calm", tag:"sunrise" },
      { id:"c2", src:"https://images.unsplash.com/photo-1448375240586-882707db888b?w=800&q=80", type:"image", orientation:"h", caption:"Forest edge", time:"06:08", location:"Point Reyes, CA", weather:"54°F · Clear", tag:"sunrise" },
      { id:"d1", src:"https://images.unsplash.com/photo-1500375592092-40eb2168fd21?w=800&q=80", type:"image", orientation:"h", caption:"Waves catch the last light", time:"20:28", location:"Point Reyes, CA", weather:"61°F · Breezy · Wind NW 18mph", tag:"sunset" },
      { id:"d2", src:"https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800&q=80", type:"image", orientation:"h", caption:"Tropical blue hour", time:"20:41", location:"Point Reyes, CA", weather:"60°F · Clear", tag:"sunset" },
    ]
  },
  {
    date: "2025-06-11",
    label: "Wednesday, June 11",
    images: [
      { id:"e1", src:"https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=800&q=80", type:"image", orientation:"h", caption:"Mountain breath", time:"05:49", location:"Mt. Tamalpais, CA", weather:"48°F · Clear", tag:"sunrise" },
      { id:"e2", src:"https://images.unsplash.com/photo-1445262102387-5fbb30a5e59d?w=800&q=80", type:"image", orientation:"h", caption:"Into the valley", time:"06:02", location:"Mt. Tamalpais, CA", weather:"50°F · Clear", tag:"sunrise" },
      { id:"e3", src:"https://images.unsplash.com/photo-1425082661705-1834bfd09dca?w=600&q=80", type:"image", orientation:"v", caption:"Narrow light", time:"06:17", location:"Mt. Tamalpais, CA", weather:"52°F · Clear", tag:"sunrise" },
      { id:"e4", src:"https://images.unsplash.com/photo-1505765050516-f72dcac9c60e?w=800&q=80", type:"image", orientation:"h", caption:"Fog layer below", time:"06:33", location:"Mt. Tamalpais, CA", weather:"54°F · Clear above clouds", tag:"sunrise" },
      { id:"e5", src:"https://images.unsplash.com/photo-1453728013993-6d66e9c9123a?w=800&q=80", type:"image", orientation:"h", caption:"Lens into sun", time:"06:44", location:"Mt. Tamalpais, CA", weather:"55°F · Clear", tag:"sunrise" },
      { id:"f1", src:"https://images.unsplash.com/photo-1495616811223-4d98c6e9c869?w=800&q=80", type:"image", orientation:"h", caption:"Fire in the west", time:"20:15", location:"Mt. Tamalpais, CA", weather:"63°F · Clear", tag:"sunset" },
      { id:"f2", src:"https://images.unsplash.com/photo-1486870591958-9b9d0d1dda99?w=800&q=80", type:"image", orientation:"h", caption:"Lavender descent", time:"20:32", location:"Mt. Tamalpais, CA", weather:"61°F · Clear", tag:"sunset" },
    ]
  },
];

// ═══════════════════════════════════════════════════════════
// HELPERS
// ═══════════════════════════════════════════════════════════
function formatDate(iso) {
  const [y,m,d] = iso.split('-');
  const dt = new Date(y, m-1, d);
  return dt.toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' });
}

// Build a flat index of all images across all days for lightbox navigation
let FLAT = [];
DAYS.forEach((day, di) => {
  day.images.forEach((img, ii) => {
    FLAT.push({ ...img, dayIndex: di, imgIndex: ii });
  });
});

let currentFlatIndex = 0;
let heroFlatIndex = 0;

// ═══════════════════════════════════════════════════════════
// RENDER HERO
// ═══════════════════════════════════════════════════════════
function renderHero() {
  const heroDay = DAYS.find(d => d.hero);
  if (!heroDay) return;
  const img = heroDay.images[heroDay.heroIndex] || heroDay.images[0];
  document.getElementById('hero-img').src = img.src;
  document.getElementById('hero-caption').textContent = img.caption;
  document.getElementById('hero-tag').textContent = img.tag.charAt(0).toUpperCase() + img.tag.slice(1);
  document.getElementById('hero-tag').style.background = img.tag === 'sunrise' ? 'rgba(200,131,60,0.92)' : 'rgba(180,70,40,0.92)';
  document.getElementById('hero-data').innerHTML =
    `${heroDay.label}<br>${img.time} · ${img.location}<br>${img.weather}`;
  heroFlatIndex = FLAT.findIndex(f => f.id === img.id);
}

// ═══════════════════════════════════════════════════════════
// RENDER TIMELINE
// ═══════════════════════════════════════════════════════════
function renderTimeline() {
  const container = document.getElementById('timeline');
  container.innerHTML = '';

  let total = 0;

  DAYS.forEach((day, di) => {
    const sunrise = day.images.filter(i => i.tag === 'sunrise');
    const sunset  = day.images.filter(i => i.tag === 'sunset');
    total += day.images.length;

    const block = document.createElement('div');
    block.className = 'day-block';

    // Header
    const hdr = document.createElement('div');
    hdr.className = 'day-header';
    hdr.innerHTML = `
      <span class="day-date">${formatDate(day.date)}</span>
      <span class="day-count">${sunrise.length} sunrise · ${sunset.length} sunset · ${day.images.length} total</span>
    `;
    block.appendChild(hdr);

    // Contact strip
    const strip = document.createElement('div');
    strip.className = 'contact-strip';

    // Left cluster: sunrise
    const leftCluster = document.createElement('div');
    leftCluster.className = 'cluster cluster-sunrise';
    sunrise.forEach(img => {
      leftCluster.appendChild(makeThumb(img));
    });

    // Gap zone
    const gap = document.createElement('div');
    gap.className = 'gap-zone';
    const gapCount = Math.max(0, 50 - day.images.length);
    gap.innerHTML = `<span class="gap-label">${gapCount > 0 ? gapCount + ' open frames' : 'full day'}</span>`;

    // Right cluster: sunset
    const rightCluster = document.createElement('div');
    rightCluster.className = 'cluster cluster-sunset';
    sunset.forEach(img => {
      rightCluster.appendChild(makeThumb(img));
    });

    strip.appendChild(leftCluster);
    strip.appendChild(gap);
    strip.appendChild(rightCluster);
    block.appendChild(strip);
    container.appendChild(block);
  });

  document.getElementById('footer-count').textContent = `${total} photographs archived`;
}

function makeThumb(img) {
  const flatIdx = FLAT.findIndex(f => f.id === img.id);
  const wrap = document.createElement('div');
  wrap.className = 'thumb-wrap' +
    (img.orientation === 'v' ? ' vertical' : '') +
    (img.type === 'video' ? ' is-video' : '');

  const el = img.type === 'video'
    ? Object.assign(document.createElement('video'), { src: img.src, muted: true, loop: true })
    : Object.assign(document.createElement('img'), { src: img.src, alt: img.caption, loading: 'lazy' });

  const tag = document.createElement('div');
  tag.className = `thumb-tag ${img.tag}`;
  tag.textContent = img.tag;

  wrap.appendChild(el);
  wrap.appendChild(tag);
  wrap.addEventListener('click', () => openLightbox(flatIdx));
  return wrap;
}

// ═══════════════════════════════════════════════════════════
// LIGHTBOX
// ═══════════════════════════════════════════════════════════
function openLightboxFromHero() {
  openLightbox(heroFlatIndex);
}

function openLightbox(idx) {
  currentFlatIndex = idx;
  document.getElementById('lightbox').classList.add('open');
  document.body.style.overflow = 'hidden';
  renderLightboxFrame();
}

function closeLightbox() {
  document.getElementById('lightbox').classList.remove('open');
  document.body.style.overflow = '';
  document.getElementById('lb-video').pause();
}

function stepLightbox(dir) {
  const next = currentFlatIndex + dir;
  if (next < 0 || next >= FLAT.length) return;
  currentFlatIndex = next;
  renderLightboxFrame();
}

function renderLightboxFrame() {
  const item = FLAT[currentFlatIndex];
  const lbImg   = document.getElementById('lb-img');
  const lbVideo = document.getElementById('lb-video');

  if (item.type === 'video') {
    lbImg.style.display = 'none';
    lbVideo.style.display = 'block';
    lbVideo.src = item.src;
    lbVideo.play();
  } else {
    lbVideo.style.display = 'none';
    lbVideo.pause();
    lbImg.style.display = 'block';
    lbImg.src = item.src;
    lbImg.alt = item.caption;
  }

  const tagHtml = `<span class="tag-pill ${item.tag}">${item.tag}</span><br>`;
  document.getElementById('lb-caption').textContent = item.caption;
  document.getElementById('lb-meta').innerHTML = `
    ${tagHtml}
    ${item.time}<br>
    ${item.location}<br>
    ${item.weather}
  `;

  document.getElementById('lb-counter').textContent =
    `${currentFlatIndex + 1} / ${FLAT.length}`;

  document.getElementById('lb-prev').disabled = (currentFlatIndex === 0);
  document.getElementById('lb-next').disabled = (currentFlatIndex === FLAT.length - 1);
}

// Keyboard nav
document.addEventListener('keydown', e => {
  if (!document.getElementById('lightbox').classList.contains('open')) return;
  if (e.key === 'ArrowLeft')  stepLightbox(-1);
  if (e.key === 'ArrowRight') stepLightbox(1);
  if (e.key === 'Escape')     closeLightbox();
});

// Click outside to close
document.getElementById('lightbox').addEventListener('click', function(e) {
  if (e.target === this) closeLightbox();
});

// ═══════════════════════════════════════════════════════════
// INIT
// ═══════════════════════════════════════════════════════════
renderHero();
renderTimeline();
</script>

</body>
</html>
